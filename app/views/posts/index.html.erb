<% current_week = @posts.first.published_at.strftime('%W') %>
<% first_week = @posts.last.published_at.strftime('%W') %>

<li><%=link_to "Update Feed",update_all_posts_path%></li>

<ul class="block feed-entries">
  <% (first_week..current_week).reverse_each do |i| %>

    <div class="clearfix block filter-group">

      <% @posts.reverse.each_with_index do |post, index| %>
        <% if (post.published_at.strftime('%W') == i) && (post.name.include? 'Control') %>

          <% content_stripped = Nokogiri::HTML(post.content) %>
          <% @img_srcs = content_stripped.css('img').map{ |i| i['src'] } %>

          <div class="entry">
            <%= image_tag @img_srcs[0], class: 'giffy' %>
          </div>

        <% end %>
      <%end%>

    </div>

  <% end %>
</ul>